
# Steal Resources (target)
situation_espionage_resources = {
	picture = GFX_evt_ship_offloading_cargo
	category = positive
	complete_icon = GFX_situation_outcome_positive
	complete_icon_frame = GFX_situation_outcome_frame_green

	on_start = {
		random_espionage_operation = {
			limit = { has_espionage_operation_flag = espionage_attacker@root }
			save_event_target_as = espionage_operation
		}
		target = {
			root = { set_situation_flag = situation_espionage_resources }
			planet_event = { id = situation_operation.1201 }
		}
	}

	on_monthly = {
		# TODO: Random events?
	}

	on_progress_complete = {
		# Show event window for defender to punish attacker.
		hidden_effect = {
			if = {
				limit = { exists = event_target:espionage_operation }
				event_target:espionage_operation.owner = {
					# TODO: Inform attack of failure immediately.
				}
				destroy_espionage_operation = event_target:espionage_operation
			}
		}
		# End this situation.
		destroy_situation = this
	}

	on_abort = {
		target = {
			if = {
				limit = { exists = event_target:espionage_operation }
				event_target:espionage_operation = {
					# TODO: Show an event window for attacker?
					destroy_espionage_operation = this
				}
			}
		}
	}

	abort_trigger = {
		OR = {
			NOT = {
				exists = target.owner
			}
			target.owner = {
				NOT = {
					is_same_value = root.owner
				}
			}
		}
	}

	stages = {
		stage_1 = {
			icon = GFX_situation_stage_1
			icon_background = GFX_situation_stage_frame_red
			custom_tooltip = situation_espionage_resources_1
			end = 20
		}
		stage_2 = {
			icon = GFX_situation_stage_2
			icon_background = GFX_situation_stage_frame_blue
			custom_tooltip = situation_espionage_resources_2
			end = 40
		}
		stage_3 = {
			icon = GFX_situation_stage_3
			icon_background = GFX_situation_stage_frame_blue
			custom_tooltip = situation_espionage_resources_3
			end = 60
		}
		stage_4 = {
			icon = GFX_situation_stage_4
			icon_background = GFX_situation_stage_frame_blue
			custom_tooltip = situation_espionage_resources_4
			end = 80
		}
		stage_5 = {
			icon = GFX_situation_stage_5
			icon_background = GFX_situation_stage_frame_green
			custom_tooltip = situation_espionage_resources_5
			end = 100
		}
	}

	monthly_progress = {
		base = 8
		modifier = {
			desc = situation_espionage_resources_approach_nothing
			current_situation_approach = situation_espionage_resources_approach_nothing
			add = 0
		}
		modifier = {
			desc = situation_espionage_resources_approach_basic_weak
			current_situation_approach = situation_espionage_resources_approach_basic_weak
			add = 1
		}
		modifier = {
			desc = situation_espionage_resources_approach_basic_strong
			current_situation_approach = situation_espionage_resources_approach_basic_strong
			add = 2
		}
		modifier = {
			desc = situation_espionage_resources_approach_weak_police
			current_situation_approach = situation_espionage_resources_approach_weak_police
			add = 2
		}
		modifier = {
			desc = situation_espionage_resources_approach_strong_police
			current_situation_approach = situation_espionage_resources_approach_strong_police
			add = 3
		}
		modifier = {
			desc = situation_espionage_resources_approach_weak_soldiers
			current_situation_approach = situation_espionage_resources_approach_weak_soldiers
			add = 2
		}
		modifier = {
			desc = situation_espionage_resources_approach_strong_soldiers
			current_situation_approach = situation_espionage_resources_approach_strong_soldiers
			add = 3
		}
		modifier = {
			desc = situation_espionage_resources_approach_weak_task_force
			current_situation_approach = situation_espionage_resources_approach_weak_task_force
			add = 2
		}
		modifier = {
			desc = situation_espionage_resources_approach_strong_task_force
			current_situation_approach = situation_espionage_resources_approach_strong_task_force
			add = 3
		}
		modifier = {
			desc = situation_espionage_resources_approach_weak_counter
			current_situation_approach = situation_espionage_resources_approach_weak_counter
			add = 4
		}
		modifier = {
			desc = situation_espionage_resources_approach_strong_counter
			current_situation_approach = situation_espionage_resources_approach_strong_counter
			add = 6
		}
	}

	approach = {
		name = situation_espionage_resources_approach_nothing
		icon = GFX_situation_approach_this_is_fine
		icon_background = GFX_situation_approach_bg_yellow
		on_select = {
			custom_tooltip = approach_outcome_tooltip
		}
		ai_weight = {
			base = 0
		}
	}

	approach = {
		name = situation_espionage_resources_approach_basic_weak
		icon = GFX_situation_approach_this_is_fine
		icon_background = GFX_situation_approach_bg_yellow
		on_select = {
			custom_tooltip = approach_outcome_tooltip
		}
		triggered_target_modifier = {
			modifier = {
				planet_jobs_produces_mult = -0.02
				planet_jobs_unity_produces_mult = -0.10
			}
		}
		ai_weight = {
			base = 10
		}
	}

	approach = {
		name = situation_espionage_resources_approach_basic_strong
		icon = GFX_situation_approach_this_is_fine
		icon_background = GFX_situation_approach_bg_yellow
		on_select = {
			custom_tooltip = approach_outcome_tooltip
		}
		triggered_target_modifier = {
			modifier = {
				pop_happiness = -0.10
				planet_jobs_produces_mult = -0.05
				planet_jobs_unity_produces_mult = -0.10
			}
		}
		ai_weight = {
			base = 10
		}
	}

	approach = {
		name = situation_espionage_resources_approach_weak_police
		icon = GFX_situation_approach_this_is_fine
		icon_background = GFX_situation_approach_bg_yellow
		potential = {
			target.owner = { is_authoritarian = yes }
		}
		on_select = {
			custom_tooltip = approach_outcome_tooltip
		}
		triggered_target_modifier = {
			modifier = {
				pop_happiness = -0.05
			}
		}
		ai_weight = {
			base = 20
		}
	}

	approach = {
		name = situation_espionage_resources_approach_strong_police
		icon = GFX_situation_approach_this_is_fine
		icon_background = GFX_situation_approach_bg_yellow
		potential = {
			target.owner = { is_authoritarian = yes }
		}
		on_select = {
			custom_tooltip = approach_outcome_tooltip
		}
		triggered_target_modifier = {
			modifier = {
				pop_happiness = -0.15
			}
		}
		ai_weight = {
			base = 20
		}
	}

	approach = {
		name = situation_espionage_resources_approach_weak_soldiers
		icon = GFX_situation_approach_this_is_fine
		icon_background = GFX_situation_approach_bg_yellow
		potential = {
			target.owner = { is_militarist = yes }
		}
		on_select = {
			custom_tooltip = approach_outcome_tooltip
		}
		triggered_target_modifier = {
			modifier = {
				pop_happiness = -0.10
				planet_stability_add = -5
				planet_soldiers_unity_produces_add = 1.5
			}
		}
		ai_weight = {
			base = 20
		}
	}

	approach = {
		name = situation_espionage_resources_approach_strong_soldiers
		icon = GFX_situation_approach_this_is_fine
		icon_background = GFX_situation_approach_bg_yellow
		potential = {
			target.owner = { is_militarist = yes }
		}
		on_select = {
			custom_tooltip = approach_outcome_tooltip
		}
		triggered_modifier = {
			modifier = {
				intel_encryption_add = 0.5
			}
		}
		triggered_target_modifier = {
			modifier = {
				pop_happiness = -0.20
				planet_stability_add = -15
			}
		}
		ai_weight = {
			base = 20
		}
	}

	approach = {
		name = situation_espionage_resources_approach_weak_task_force
		icon = GFX_situation_approach_this_is_fine
		icon_background = GFX_situation_approach_bg_yellow
		potential = {
			target.owner = { is_egalitarian = yes }
		}
		on_select = {
			custom_tooltip = approach_outcome_tooltip
		}
		triggered_target_modifier = {
			modifier = {
				pop_happiness = 0.05
			}
		}
		resources = {
			category = country_situations
			upkeep = {
				energy = 20
			}
		}
		ai_weight = {
			base = 20
		}
	}

	approach = {
		name = situation_espionage_resources_approach_strong_task_force
		icon = GFX_situation_approach_this_is_fine
		icon_background = GFX_situation_approach_bg_yellow
		potential = {
			target.owner = { is_egalitarian = yes }
		}
		on_select = {
			custom_tooltip = approach_outcome_tooltip
		}
		triggered_target_modifier = {
			modifier = {
				pop_happiness = 0.08
			}
		}
		resources = {
			category = country_situations
			upkeep = {
				energy = 50
			}
		}
		ai_weight = {
			base = 20
		}
	}

	approach = {
		name = situation_espionage_resources_approach_weak_counter
		icon = GFX_situation_approach_this_is_fine
		icon_background = GFX_situation_approach_bg_yellow
		potential = {
			target.owner = { is_pacifist = yes }
		}
		on_select = {
			custom_tooltip = approach_outcome_tooltip
		}
		triggered_modifier = {
			modifier = {
				hostile_operation_steal_resources_difficulty_add = 2
			}
		}
		triggered_target_modifier = {
			modifier = {
				planet_jobs_unity_produces_mult = 0.10
				planet_jobs_produces_mult = -0.05
			}
		}
		ai_weight = {
			base = 20
		}
	}

	approach = {
		name = situation_espionage_resources_approach_strong_counter
		icon = GFX_situation_approach_this_is_fine
		icon_background = GFX_situation_approach_bg_yellow
		potential = {
			target.owner = { is_pacifist = yes }
		}
		on_select = {
			custom_tooltip = approach_outcome_tooltip
		}
		triggered_modifier = {
			modifier = {
				intel_encryption_add = 1
				hostile_operation_steal_resources_difficulty_add = 2
			}
		}
		triggered_target_modifier = {
			modifier = {
				planet_jobs_unity_produces_mult = 0.30
				planet_jobs_produces_mult = -0.05
			}
		}
		ai_weight = {
			base = 20
		}
	}

}
